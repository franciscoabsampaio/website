<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Francisco A. B. Sampaio</title>
<link>https://franciscoabsampaio.com/blog.html</link>
<atom:link href="https://franciscoabsampaio.com/blog.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.8.26</generator>
<lastBuildDate>Thu, 20 Nov 2025 00:00:00 GMT</lastBuildDate>
<item>
  <title>Exploring Data with Python</title>
  <link>https://franciscoabsampaio.com/blog/2025-2b-model-at-home/</link>
  <description><![CDATA[ 




<p>In this post we‚Äôll do a quick exploration using Python and pandas.</p>
<div id="f4049d78" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create sample data</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span></code></pre></div></div>
<div class="cell-output cell-output-stdout">
<pre><code>123</code></pre>
</div>
</div>
<section id="activation-checkpoints" class="level2">
<h2 class="anchored" data-anchor-id="activation-checkpoints">Activation Checkpoints</h2>
<p>Activation checkpointing consists of selectively forgetting activations during each training loop, effectively trading off compute for a shallower memory footprint. The concept (expertly presented in <a href="https://medium.com/tensorflow/fitting-larger-networks-into-memory-583e3c758ff9">this blog post</a> by <span class="citation" data-cites="2018_medium_activation_checkpoint">Bulatov (2018)</span>) is a clever exploitation of dependencies in the model graph that can reduce memory requirements during training from <code>O(n^2)</code> to <code>O(sqrt(n))</code> - all for the modest cost of an extra forward pass.</p>
<p>If we picture the training loop as a directed graph, with each layer‚Äôs activations as nodes on the graph, and activations triggering dependent nodes in a cascading fashion, one way of managing our GPU‚Äôs memory would be to store every node‚Äôs values until a complete pass of the training loop is complete. Clearly, this would not be a good idea if - after all, why store the activations of the first nodes in the graph if we only need the preceding node‚Äôs activations for any given node? It would be much more memory efficient to forget node values as we progress through the graph:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://franciscoabsampaio.com/blog/2025-2b-model-at-home/images/activation_checkpoint_rich.webp" title="Rich man's activation checkpointing" class="img-fluid figure-img"></p>
<figcaption>Rich man‚Äôs activation checkpointing <span class="citation" data-cites="2018_medium_activation_checkpoint">(Bulatov 2018)</span>.</figcaption>
</figure>
</div>
<p>A big problem with training is that the backward pass starts from the loss node (computed from the last node of the forward pass) and moves in reverse order - if we only vacate computed nodes from memory after they‚Äôre no longer needed, we will be keeping a lot of forward pass activations as we walk through the backward pass. The poor man‚Äôs solution would be to forget every node <em>as soon as it is consumed</em> - but this results in a quadratic increase of computations:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://franciscoabsampaio.com/blog/2025-2b-model-at-home/images/activation_checkpoint_poor.webp" title="Poor man's activation checkpointing" class="img-fluid figure-img"></p>
<figcaption>Poor man‚Äôs activation checkpointing <span class="citation" data-cites="2018_medium_activation_checkpoint">(Bulatov 2018)</span>.</figcaption>
</figure>
</div>
<p><span class="citation" data-cites="2016_activation_checkpoint">Chen et al. (2016)</span> found an effective middle ground: by saving intermediate nodes every <code>sqrt(n)</code> steps - <strong>checkpoints</strong> - and forgetting all those that won‚Äôt be needed in the next step, the memory footprint can be greatly reduced, for the modest cost of a second forward pass‚Äô worth of compute:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://franciscoabsampaio.com/blog/2025-2b-model-at-home/images/activation_checkpoint_smart.webp" title="Smart man's activation checkpointing" class="img-fluid figure-img"></p>
<figcaption>Smart man‚Äôs activation checkpointing <span class="citation" data-cites="2018_medium_activation_checkpoint">(Bulatov 2018)</span>.</figcaption>
</figure>
</div>
<p><a href="https://en.wikipedia.org/wiki/Pebble_game">This pebble game we‚Äôre playing</a> can get extremely complex (dynamic programming, tree decomposition, etc), but this much will suffice us.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-2018_medium_activation_checkpoint" class="csl-entry">
Bulatov, Yaroslav. 2018. <span>‚ÄúFitting Larger Networks into Memory.‚Äù</span> 2018. <a href="https://medium.com/tensorflow/fitting-larger-networks-into-memory-583e3c758ff9">https://medium.com/tensorflow/fitting-larger-networks-into-memory-583e3c758ff9</a>.
</div>
<div id="ref-2016_activation_checkpoint" class="csl-entry">
Chen, Tianqi, Bing Xu, Chiyuan Zhang, and Carlos Guestrin. 2016. <span>‚ÄúTraining Deep Nets with Sublinear Memory Cost.‚Äù</span> <em>arXiv Preprint arXiv:1604.06174</em>.
</div>
</div></section></div> ]]></description>
  <category>python</category>
  <category>data</category>
  <guid>https://franciscoabsampaio.com/blog/2025-2b-model-at-home/</guid>
  <pubDate>Thu, 20 Nov 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Tutorial: Reproducible Spark+Delta Tests Without the Hassle</title>
  <link>https://franciscoabsampaio.com/blog/2025-tutorial-spark-connect/</link>
  <description><![CDATA[ 




<blockquote class="blockquote">
<p><strong>Pre-requisite:</strong> if you‚Äôre not familiar with Docker, I recommend you follow the <a href="https://docs.docker.com/get-started/introduction/">official introductory guide</a>.</p>
</blockquote>
<hr>
<p>Setting up a Spark instance can be quite the hassle. Add a data catalog like Delta or Apache Iceberg, and the complexity blows up!</p>
<p>But testing catalog-specific queries against a Spark instance should be easy. And, if you‚Äôre an automation nerd like myself, it should be reproducible, as well.</p>
<p>Unfortunately, the traditional method of installing the OpenJDK, JVM, Spark drivers, Hive plugins, Delta jars is anything but easy, let alone reproducible <em>(As a matter of fact, on the eve of publishing this article, <a href="https://spark.apache.org/docs/latest/api/python/getting_started/index.html">the Live Notebooks on PySpark‚Äôs official quickstart page</a> failed to launch due to a bug downloading OpenJDK‚Ä¶ üòÖ)</em>.</p>
<p>Faced with this problem, I decided to take matters into my own hands ‚Äî and published <a href="https://hub.docker.com/repository/docker/franciscoabsampaio/spark-connect-server">a Docker Hub repository for running Spark Connect servers</a>!</p>
<section id="spark-connect" class="level2">
<h2 class="anchored" data-anchor-id="spark-connect">Spark Connect</h2>
<p>Spark Connect is Apache‚Äôs newest gRPC protocol for Apache Spark. It lets any client that implements the Spark Connect protocol to connect to a Spark Server, and execute workloads seamlessly.</p>
<p>What this Docker container does is take care of all the setup for launching a Spark instance <em>with</em> Spark Connect server, to make the development experience as smooth as possible.</p>
</section>
<section id="running-the-container" class="level2">
<h2 class="anchored" data-anchor-id="running-the-container">Running the Container</h2>
<p>Running it is as straight-forward as any other container. Simply:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> run <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 15002:15002 franciscoabsampaio/spark-connect-server:delta</span></code></pre></div></div>
<p>We use the ‚Äúdelta‚Äù tag if we wish to spin the server with a <a href="https://delta.io/">Delta catalog</a>, and the ‚Äúiceberg‚Äù tag for the <a href="https://iceberg.apache.org/">Iceberg catalog</a>.</p>
<p>The <code>docker run</code> command will pull the image, and start it, resulting in a generous slew of logs, ending with a message akin to ‚Äú<code>Spark Connect server started at 0.0.0.0:15002</code>‚Äù ‚Äî letting us know that the Spark instance is LIVE and ready to accept connections.</p>
<p>Now, connecting to it in PySpark is as easy as:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pyspark.sql <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SparkSession</span>
<span id="cb2-2"></span>
<span id="cb2-3">spark <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SparkSession.builder <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">    .remote(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sc://localhost:15002"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">    .getOrCreate()</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A simple check:</span></span>
<span id="cb2-8">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> spark.sql(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"SELECT 1 AS id"</span>)</span>
<span id="cb2-9">rows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.collect()</span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rows)</span></code></pre></div></div>
<blockquote class="blockquote">
<p><strong>Note:</strong> You may have to install Python packages <code>grpcio</code>, <code>grpcio-status</code> and <code>protobuf</code> for <code>pyspark</code> to connect successfully.</p>
</blockquote>
<p>The Spark session is ON and completely functional for all you development needs.</p>
</section>
<section id="reproducible-tests" class="level2">
<h2 class="anchored" data-anchor-id="reproducible-tests">Reproducible Tests</h2>
<p>If you‚Äôd like to take things a step further, we can manage the Spark server‚Äôs lifecycle entirely in our test suite, ensuring reproducible, specified-in-code, end-to-end dependencies.</p>
<p>To do so, we can create a <a href="https://docs.pytest.org/en/6.2.x/fixture.html">pytest fixture</a>, which is essentially a reusable resource for tests!</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> docker</span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># You can use testcontainers instead of the docker package</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># but I find it a bit bloated and buggy</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># when working with custom images.</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The docker package is what testcontainers uses</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># behind the scenes, and I find it more consistent.</span></span>
<span id="cb3-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pytest</span>
<span id="cb3-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb3-9"></span>
<span id="cb3-10"></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Utility function:</span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Once the container has produced the desired message, return.</span></span>
<span id="cb3-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> wait_for_log(container, message, timeout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb3-14">    start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time()</span>
<span id="cb3-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>:</span>
<span id="cb3-16">        logs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> container.logs().decode(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"utf-8"</span>)</span>
<span id="cb3-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> message <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> logs:</span>
<span id="cb3-18">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span></span>
<span id="cb3-19">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> time.time() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> timeout:</span>
<span id="cb3-20">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">TimeoutError</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Message '</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>message<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">' not found in logs"</span>)</span>
<span id="cb3-21">        time.sleep(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb3-22"></span>
<span id="cb3-23"></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The default scope is function,</span></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># which means the fixture is created and destroyed every test.</span></span>
<span id="cb3-26"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@pytest.fixture</span>(scope<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"function"</span>)</span>
<span id="cb3-27"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> spark_connect_server_url():</span>
<span id="cb3-28">    docker_client <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> docker.from_env()</span>
<span id="cb3-29"></span>
<span id="cb3-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let's run a Spark Connect server with a Delta catalog!</span></span>
<span id="cb3-31">    container <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> docker_client.containers.run(</span>
<span id="cb3-32">        image<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"franciscoabsampaio/spark-connect-server:delta"</span>,</span>
<span id="cb3-33">        detach<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb3-34">        ports<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'15002/tcp'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15002</span>}</span>
<span id="cb3-35">    )</span>
<span id="cb3-36">    wait_for_log(container, message<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spark Connect server started"</span>)</span>
<span id="cb3-37"></span>
<span id="cb3-38">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass the connection string to whoever is using the fixture.</span></span>
<span id="cb3-39">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">yield</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sc://localhost:15002"</span></span>
<span id="cb3-40"></span>
<span id="cb3-41">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cleanup</span></span>
<span id="cb3-42">    container.stop()</span></code></pre></div></div>
<p>Now, we can simply pass the fixture to whichever test requires a running Spark Connect server. For example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> test_basic_read(spark_connect_server_url):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use the fixture</span></span>
<span id="cb4-2">    spark <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SparkSession.builder <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-3">        .remote(spark_connect_server_url) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">        .getOrCreate()</span>
<span id="cb4-5"></span>
<span id="cb4-6">    table_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"test_table"</span></span>
<span id="cb4-7"></span>
<span id="cb4-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CREATE TABLE USING DELTA</span></span>
<span id="cb4-9">    spark.sql(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"""</span></span>
<span id="cb4-10"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">        CREATE TABLE </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>table_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> (</span></span>
<span id="cb4-11"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">            id INT,</span></span>
<span id="cb4-12"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">            name STRING</span></span>
<span id="cb4-13"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">        )</span></span>
<span id="cb4-14"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">        USING DELTA</span></span>
<span id="cb4-15"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span>)</span>
<span id="cb4-16"></span>
<span id="cb4-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># INSERT INTO TABLE</span></span>
<span id="cb4-18">    spark.sql(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"INSERT INTO </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>table_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> VALUES (1, 'bird'), (2, 'spark')"</span>)</span>
<span id="cb4-19"></span>
<span id="cb4-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SELECT * FROM TABLE</span></span>
<span id="cb4-21">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> spark.sql(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"SELECT * FROM </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>table_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> ORDER BY id"</span>)</span>
<span id="cb4-22">    rows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.collect()</span>
<span id="cb4-23"></span>
<span id="cb4-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test conditions</span></span>
<span id="cb4-25">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(rows) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb4-26">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> rows[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> rows[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bird"</span></span></code></pre></div></div>
<p>The yield statement locks the fixture execution until the test finishes ‚Äî at which point the cleanup code is executed.</p>
<hr>
<p>And that‚Äôs it ‚Äî you now have a fully reproducible, containerized Spark + Delta test setup, ready to integrate into any CI/CD pipeline or local test suite.</p>
<p>You can find the container on Docker Hub: üëâ <a href="https://hub.docker.com/repository/docker/franciscoabsampaio/spark-connect-server">franciscoabsampaio/spark-connect-server</a></p>
<p>If this saved you time (or frustration), give it a ‚≠êÔ∏è on GitHub or share it with your team ‚Äî and let me know what feature you‚Äôd like supported next!</p>
<p><strong>Happy testing! üöÄ</strong></p>


</section>

 ]]></description>
  <category>spark</category>
  <category>delta</category>
  <category>docker</category>
  <guid>https://franciscoabsampaio.com/blog/2025-tutorial-spark-connect/</guid>
  <pubDate>Wed, 22 Oct 2025 23:00:00 GMT</pubDate>
</item>
</channel>
</rss>
